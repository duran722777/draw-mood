<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë“œë¡œì‰ ê¸°ë¶„ ë¶„ì„ê¸° + ê´‘ê³ </title>
<style>
body { font-family: 'Segoe UI', sans-serif; background:#f0f4f8; display:flex; flex-direction:column; align-items:center; padding:20px; margin:0;}
h1 { color:#333; text-align:center;}
canvas { border:2px solid #333; border-radius:10px; background:#fff; cursor:crosshair; margin-bottom:15px;}
.controls { display:flex; gap:10px; margin-bottom:20px;}
button { padding:8px 15px; border:none; border-radius:6px; background:#4a90e2; color:white; font-size:14px; cursor:pointer;}
button:hover { background:#357ABD;}
#moodResult { font-size:18px; color:#333; text-align:center; min-height:24px; margin-bottom:20px;}
#adContainer { width:320px; height:100px; margin-top:10px; }
</style>
</head>
<body>

<h1>ğŸ¨ ë“œë¡œì‰ ê¸°ë¶„ ë¶„ì„ê¸° + ê´‘ê³ </h1>
<canvas id="drawCanvas" width="400" height="400"></canvas>

<div class="controls">
  <button id="clearBtn">ì§€ìš°ê¸°</button>
  <button id="analyzeBtn">ë¶„ì„í•˜ê¸°</button>
</div>

<div id="moodResult"></div>

<!-- ê´‘ê³  ì˜ì—­ -->
<div id="adContainer">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4634078773523032"
     crossorigin="anonymous"></script>
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-4634078773523032"
       data-ad-slot="1234567890"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>

<script>
const canvas = document.getElementById('drawCanvas');
const ctx = canvas.getContext('2d');
let drawing=false, lastX=0, lastY=0;
ctx.lineWidth=5; ctx.lineCap='round'; ctx.strokeStyle='#ff6f61';

// ê·¸ë¦¬ê¸°
function startDraw(x,y){ drawing=true; lastX=x; lastY=y; ctx.beginPath(); ctx.moveTo(lastX,lastY);}
function drawLine(x,y){ if(!drawing) return; ctx.lineTo(x,y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x,y);}
canvas.addEventListener('mousedown', e=>{ const rect=canvas.getBoundingClientRect(); startDraw(e.clientX-rect.left,e.clientY-rect.top);});
canvas.addEventListener('mouseup', ()=>drawing=false);
canvas.addEventListener('mouseleave', ()=>drawing=false);
canvas.addEventListener('mousemove', e=>{ const rect=canvas.getBoundingClientRect(); drawLine(e.clientX-rect.left, e.clientY-rect.top);});
canvas.addEventListener('touchstart', e=>{ e.preventDefault(); const rect=canvas.getBoundingClientRect(); startDraw(e.touches[0].clientX-rect.left,e.touches[0].clientY-rect.top);});
canvas.addEventListener('touchend', ()=>drawing=false);
canvas.addEventListener('touchmove', e=>{ e.preventDefault(); const rect=canvas.getBoundingClientRect(); drawLine(e.touches[0].clientX-rect.left,e.touches[0].clientY-rect.top);});

// ì§€ìš°ê¸°
document.getElementById('clearBtn').addEventListener('click', ()=>{ ctx.clearRect(0,0,canvas.width,canvas.height); document.getElementById('moodResult').textContent=''; });

// ë¶„ì„
document.getElementById('analyzeBtn').addEventListener('click', ()=>{
  const imageData=ctx.getImageData(0,0,canvas.width,canvas.height); const data=imageData.data;
  let colorCounts={red:0,green:0,blue:0,yellow:0,pink:0,black:0,white:0}, count=0;
  let strokeCount=0;
  let symbolScores={love:0,sad:0,hope:0,stress:0};
  let faceScores={happy:0,sad:0,angry:0};

  // ìƒ‰ìƒ ë° ì‹¬ë³¼ ë¶„ì„
  for(let i=0;i<data.length;i+=4){
    const r=data[i], g=data[i+1], b=data[i+2], a=data[i+3];
    if(a>0){
      count++;
      // ìƒ‰ìƒ êµ¬ë¶„
      if(r>200 && g<100 && b<100) colorCounts.red++;
      else if(g>200 && r<100 && b<100) colorCounts.green++;
      else if(b>200 && r<100 && g<100) colorCounts.blue++;
      else if(r>200 && g>200 && b<100) colorCounts.yellow++;
      else if(r>200 && g<100 && b>150) colorCounts.pink++;
      else if(r<50 && g<50 && b<50) colorCounts.black++;
      else if(r>200 && g>200 && b>200) colorCounts.white++;

      // ì‹¬ë³¼ ìƒ‰ìƒ
      if(Math.abs(r-255)<50 && Math.abs(g-0)<50 && Math.abs(b-100)<50) symbolScores.love++;
      if(Math.abs(r-0)<50 && Math.abs(g-150)<50 && Math.abs(b-255)<50) symbolScores.sad++;
      if(Math.abs(r-255)<50 && Math.abs(g-255)<50 && Math.abs(b-0)<50) symbolScores.hope++;
    }
  }

  // ìƒ‰ìƒ ì ìˆ˜
  let moodScore=0;
  for(let key in colorCounts){
    moodScore += colorCounts[key]/count*10;
  }

  // ì„  êµµê¸° ì ìˆ˜
  strokeCount = ctx.lineWidth;
  if(strokeCount>5) moodScore+=2;

  // ì–¼êµ´ ë‹¨ìˆœ ë¶„ì„ (ì¤‘ì•™ ì˜ì—­)
  let centerStart=Math.floor(canvas.width/2), centerEnd=Math.floor(canvas.width/2+50);
  for(let y=centerStart;y<centerEnd;y++){
    for(let x=centerStart;x<centerEnd;x++){
      const idx=(y*canvas.width + x)*4;
      const r=data[idx], g=data[idx+1], b=data[idx+2], a=data[idx+3];
      if(a>0){
        if(r>180 && g<120 && b<120) faceScores.happy++;
        if(b>150 && r<120 && g<120) faceScores.sad++;
        if(r<50 && g<50 && b<50) faceScores.angry++;
      }
    }
  }

  // 30ê°€ì§€ ë©”ì‹œì§€
  const messages=[
"ì˜¤ëŠ˜ì€ í™œê¸°ì°¨ê³  ì—´ì •ì ì¸ í•˜ë£¨!", "ì¡°ìš©í•˜ì§€ë§Œ ì•ˆì •ëœ ê¸°ë¶„ì´ì—ìš”.", "ì‚¬ë‘ê³¼ í–‰ë³µì´ ëŠê»´ì§€ëŠ” ë‚ ì´ì—ìš” â¤ï¸",
"ì¡°ê¸ˆ ìš°ìš¸í•˜ì§€ë§Œ ì°¨ë¶„í•œ í•˜ë£¨ë„¤ìš” ğŸ˜¢", "ê¸°ëŒ€ì™€ í¬ë§ì´ ê°€ë“í•œ ë‚ ì´ì—ìš” ğŸŒŸ", "ê¸´ì¥ë˜ì§€ë§Œ í¥ë¯¸ë¡œìš´ í•˜ë£¨ì˜ˆìš”",
"ì°¨ë¶„í•˜ê³  ì‚¬ìƒ‰ì ì¸ ëŠë‚Œì´ì—ìš”", "ì˜¤ëŠ˜ì€ ì¦ê±°ì›€ê³¼ ì‚¬ë‘ì´ í•¨ê»˜í•´ìš”", "í–‰ë³µí•˜ì§€ë§Œ ì¡°ê¸ˆ í”¼ê³¤í•œ ëŠë‚Œì´ì—ìš”",
"ì—´ì •ê³¼ ëª¨í—˜ì‹¬ì´ ê°€ë“í•œ ë‚ ì´ì—ìš”!", "ì¡°ìš©í•˜ê³  í¸ì•ˆí•œ ê¸°ë¶„ì´ì—ìš”", "ì‚¬ë‘ê³¼ ê¸°ì¨ì´ ë„˜ì³ìš”",
"ì¡°ê¸ˆ ìŠ¬í”„ì§€ë§Œ í¬ë§ì„ ëŠê»´ìš”", "í¥ë¶„ë˜ê³  ì„¤ë ˆëŠ” í•˜ë£¨!", "í‰í™”ë¡­ê³  ì•ˆì •ëœ ëŠë‚Œì´ì—ìš”",
"ë§ˆìŒì´ ë³µì¡í•˜ì§€ë§Œ ì¬ë¯¸ìˆëŠ” í•˜ë£¨ì˜ˆìš”", "í–‰ë³µê³¼ ë§Œì¡±ì´ í•¨ê»˜í•˜ëŠ” ë‚ ", "ê¸´ì¥ë˜ì§€ë§Œ ë„ì „ì ì¸ í•˜ë£¨!",
"ì°¨ë¶„í•˜ì§€ë§Œ ì¡°ê¸ˆ ì§€ì¹œ ê¸°ë¶„ì´ì—ìš”", "ì‚¬ë‘ê³¼ ì—´ì •ì´ ê°€ë“í•œ í•˜ë£¨ â¤ï¸", "ì¡°ê¸ˆ ìš°ìš¸í•˜ì§€ë§Œ ì°¨ë¶„í•˜ê²Œ",
"ì¦ê²ê³  í™œê¸°ì°¬ í•˜ë£¨!", "ê¸°ì¨ê³¼ ê¸°ëŒ€ê°€ ì„ì¸ ë‚  ğŸŒŸ", "ì˜¤ëŠ˜ì€ ë§ˆìŒì´ í¸ì•ˆí•´ìš”",
"í¥ë¯¸ì§„ì§„í•˜ê³  ì¬ë¯¸ìˆëŠ” í•˜ë£¨", "ì‚¬ë‘ê³¼ í–‰ë³µì´ í•¨ê»˜í•˜ëŠ” ë‚ ", "ì¡°ê¸ˆ ë¶ˆì•ˆí•˜ì§€ë§Œ ì¦ê±°ìš´ ê¸°ë¶„",
"ì°¨ë¶„í•˜ì§€ë§Œ í–‰ë³µì´ ëŠê»´ì§€ëŠ” í•˜ë£¨", "í™œê¸°ì°¨ê³  ëª¨í—˜ì ì¸ í•˜ë£¨!", "í‰í™”ë¡­ê³  ì•ˆì •ëœ ê¸°ë¶„ì´ì—ìš”"
  ];

  let totalScore = moodScore + symbolScores.love + symbolScores.sad + symbolScores.hope + faceScores.happy + faceScores.sad + faceScores.angry;
  let msgIndex = Math.floor(totalScore)%messages.length;

  document.getElementById('moodResult').textContent = messages[msgIndex];
});
</script>

</body>
</html>
