<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>드로잉 기분 분석기</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #f0f4f8;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
  }

  h1 {
    color: #333;
    text-align: center;
  }

  canvas {
    border: 2px solid #333;
    border-radius: 10px;
    background: #fff;
    cursor: crosshair;
    margin-bottom: 15px;
  }

  .controls {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
  }

  button {
    padding: 8px 15px;
    border: none;
    border-radius: 6px;
    background: #4a90e2;
    color: white;
    font-size: 14px;
    cursor: pointer;
  }

  button:hover {
    background: #357ABD;
  }

  #moodResult {
    font-size: 18px;
    color: #333;
    text-align: center;
    min-height: 24px;
  }
</style>
</head>
<body>

<h1>🎨 드로잉 기분 분석기</h1>
<canvas id="drawCanvas" width="400" height="400"></canvas>

<div class="controls">
  <button id="clearBtn">지우기</button>
  <button id="analyzeBtn">분석하기</button>
</div>

<div id="moodResult"></div>

<script>
const canvas = document.getElementById('drawCanvas');
const ctx = canvas.getContext('2d');
let drawing = false;

// 그리기 이벤트
canvas.addEventListener('mousedown', () => drawing = true);
canvas.addEventListener('mouseup', () => drawing = false);
canvas.addEventListener('mouseleave', () => drawing = false);

canvas.addEventListener('mousemove', (e) => {
  if (!drawing) return;
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;

  ctx.lineWidth = 5;
  ctx.lineCap = 'round';
  ctx.strokeStyle = '#ff6f61';
  ctx.lineTo(x, y);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(x, y);
});

// 지우기 버튼
document.getElementById('clearBtn').addEventListener('click', () => {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  document.getElementById('moodResult').textContent = '';
});

// 분석 버튼
document.getElementById('analyzeBtn').addEventListener('click', () => {
  const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
  const data = imageData.data;
  let rTotal = 0, gTotal = 0, bTotal = 0, count = 0;

  for (let i = 0; i < data.length; i += 4) {
    const r = data[i];
    const g = data[i+1];
    const b = data[i+2];
    const alpha = data[i+3];
    if(alpha > 0) {
      rTotal += r;
      gTotal += g;
      bTotal += b;
      count++;
    }
  }

  if(count === 0){
    document.getElementById('moodResult').textContent = '그림을 먼저 그려주세요!';
    return;
  }

  const rAvg = rTotal / count;
  const gAvg = gTotal / count;
  const bAvg = bTotal / count;

  let mood = '';
  if(rAvg > 150 && gAvg < 120 && bAvg < 120) mood = '열정적이고 활기찬 기분이에요!';
  else if(rAvg < 120 && gAvg > 150 && bAvg < 120) mood = '평화롭고 안정된 기분이에요!';
  else if(rAvg < 120 && gAvg < 120 && bAvg > 150) mood = '조용하고 사색적인 기분이에요!';
  else if(rAvg > 180 && gAvg > 180 && bAvg < 120) mood = '즐겁고 행복한 기분이에요!';
  else mood = '오늘의 기분은 복합적이에요. 여러 감정이 섞여 있어요.';

  document.getElementById('moodResult').textContent = mood;
});
</script>

</body>
</html>
